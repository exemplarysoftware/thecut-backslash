{% extends "backslash/accounts_base.html" %}
{% load i18n admin_static %}

{% block title %}Login - {% endblock %}

{% block extrahead %}
{{ block.super }}

<script type="text/javascript" src="{{ STATIC_URL }}backslash/javascripts/login.js"></script>
{% endblock %}

{% block page_content %}
  <h2 class="login-msg">Login to {{ current_site.name }}</h2>

  {% if form.errors and not form.non_field_errors and not form.this_is_the_login_form.errors %}
  <p class="errornote">
  {% if form.errors.items|length == 1 %}{% trans "Please correct the error below." %}{% else %}{% trans "Please correct the errors below." %}{% endif %}
  </p>
  {% endif %}

  {% if form.non_field_errors or form.this_is_the_login_form.errors %}
  {% for error in form.non_field_errors|add:form.this_is_the_login_form.errors %}
  <p class="errornote">
      {{ error }}
  </p>
  {% endfor %}
  {% endif %}

  <form action="{{ app_path }}" method="post" id="login-form">{% csrf_token %}
    <ul>
      <li class="username">
        <label for="id_username" class="required">{{ form.username.label }}</label>
        {{ form.username }}
        {% if not form.this_is_the_login_form.errors %}{{ form.username.errors }}{% endif %}
      </li>
      <li class="password">
        <label for="id_password" class="required">{% trans 'Password' %}</label>
        {{ form.password }}
        <input type="hidden" name="this_is_the_login_form" value="1" />
        <input type="hidden" name="next" value="{{ next }}" />
        {% if not form.this_is_the_login_form.errors %}{{ form.password.errors }}{% endif %}
      </li>
      <li class="submit">
        <input type="submit" value="{% trans 'Log In' %}" />
      </li>
      {% url 'admin_password_reset' as password_reset_url %}
      {% if password_reset_url %}
      <li class="password-reset-link">
        <a href="{{ password_reset_url }}">{% trans 'Forgotten your username or password?' %}</a>
      </li>
      {% endif %}
    </ul>
  </form>
{% endblock %}
